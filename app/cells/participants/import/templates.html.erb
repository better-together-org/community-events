
<script type="text/template" id="data-source-template">
    <div class="well" style="padding-bottom: 0;">
        <center>
        <div class="form-horizontal" data-fieldsets>
            <div style="float: right; padding-left: 10px;">
                <a class="btn btn-primary btn-small back-step pull-left" href="<%= baseUri%>/pages/admin_dash/system_configs#data_sources_config">
                    <%= t "create-a-data-source" %>
                </a>
            </div>
        </div>
        </center>
    </div>
</script>

<script type="text/template" id="step-layout">
    <div id='current-step'></div>
    <div id='control'></div>
</script>

<script type="text/template" id="step-control">
    <button type="button" class="btn btn-primary back-step pull-left"><%= t "back" %></button>
    <button type="button" class="btn btn-primary next-step pull-right"><%= t "next-step" %></button>
</script>

<script type="text/template" id="step-1">

    <div id="step-1-text">
        <h3 class="h3-underlined"><%= t 'people-import-wizard-step-1'%></h3>
        <div class="bs-callout bs-callout-info">
            <h4><%= t 'hint' %></h4>
            <%= (t 'before-importing-people-text').html_safe %>  
        </div>
        <p><%= t 'people-import-wizard-intro'%> <%= t 'people-import-wizard-step-1-text'%> <a href="<%= baseUri + '/pages/admin_dash/system_configs#data_sources_config' %>"><%= t 'people-import-wizard-step-1-create-data-source-link'%></a>. <%= t 'people-import-wizard-step-1-text-2' %></p>
    </div>
    <div id='form'></div>
</script>

<script type="text/template" id="step-2">
    <div id="step-2-text">
        <h3 class="h3-underlined"><%= t 'people-import-wizard-step-2'%></h3>
        <p><%= t 'people-import-wizard-step-2-text'%></p>
    </div>    
    <div id='form'></div>
</script>

<script type="text/template" id="mapping-layout">
    <div class="row">
        <div class="col-md-12">
            <div id="step-3-text">
                <h3 class="h3-underlined"><%= t 'people-import-wizard-step-3'%></h3>
                <p><%= t 'people-import-wizard-step-3-text'%></p>
                <div class="bs-callout bs-callout-info">
                    <h4><%= t 'hint'%></h4>
                    <%= (t 'dbid-hint').html_safe %>
                </div>
            </div>
        </div>
        <div class="voffset20">&nbsp;</div>
        <div class="col-xs-6">
            <h4><%= t 'grenadine-fields'%></h4>
            <div id='mapping'></div>
        </div>
        <div class="col-xs-6">
            <h4><%= t 'your-fields'%></h4>
            <div id='source'></div>
        </div>
    </div>
</script>

<script type="text/template" id="result-layout">
    <div class="row">
        <div class="col-xs-12">
            <div id='result'></div>
        </div>
    </div>
</script>

<script type="text/template" id="step-3"> 
    <div>    
        <ul class="list-group">
            <!--  What about pseudonyms? -->
            <li class="list-group-item ui-droppable" id="prefix">
                <span>prefix</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof prefix != 'undefined' && prefix != null ? src.models[prefix].get('name') : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="prefix"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="first_name">
                <span>first_name</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= (typeof first_name != 'undefined' && first_name != null) ? ParticipantApp.PeopleImport.column_name(src, first_name) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="first_name"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="last_name">
                <span>last_name</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= (typeof(last_name) != 'undefined') && last_name != null ? ParticipantApp.PeopleImport.column_name(src, last_name) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="last_name"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="suffix">
                <span>suffix</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= (typeof(suffix) != 'undefined') && suffix != null ? ParticipantApp.PeopleImport.column_name(src, suffix) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="suffix"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="job_title">
                <span>job_title</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof job_title != 'undefined' && job_title != null ? ParticipantApp.PeopleImport.column_name(src, job_title) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="job_title"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="company">
                <span>company</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof company != 'undefined' && company != null ? ParticipantApp.PeopleImport.column_name(src, company) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="company"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="line1">
                <span>line1</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof line1 != 'undefined' && line1 != null ? ParticipantApp.PeopleImport.column_name(src,line1) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="line1"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="line2">
                <span>line2</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof line2 != 'undefined' && line2 != null ? ParticipantApp.PeopleImport.column_name(src,line2) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="line2"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="city">
                <span>city</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof city != 'undefined' && city != null ? ParticipantApp.PeopleImport.column_name(src,city) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="city"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="postcode">
                <span>postcode</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof postcode != 'undefined' && postcode != null ? ParticipantApp.PeopleImport.column_name(src,postcode) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="postcode"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="state">
                <span>state</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof state != 'undefined' && state != null ? ParticipantApp.PeopleImport.column_name(src,state) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="state"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="country">
                <span>country</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof country != 'undefined' && country != null ? ParticipantApp.PeopleImport.column_name(src,country) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="country"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="phone">
                <span>phone</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof phone != 'undefined' && phone != null ? ParticipantApp.PeopleImport.column_name(src,phone) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="phone"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="email">
                <span>email</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof email != 'undefined' && email != null ? ParticipantApp.PeopleImport.column_name(src,email) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="email"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="registration_number">
                <span>registration_number</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof registration_number != 'undefined' && registration_number != null ? ParticipantApp.PeopleImport.column_name(src,registration_number) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="registration_number"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="registration_type">
                <span>registration_type</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof registration_type != 'undefined' && registration_type != null ? ParticipantApp.PeopleImport.column_name(src,registration_type) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="registration_type"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
            <li class="list-group-item ui-droppable" id="datasource_dbid">
                <span>datasource_dbid</span> <span class="glyphicon glyphicon-arrow-left"></span> <span>{{= typeof datasource_dbid != 'undefined' && datasource_dbid != null ? ParticipantApp.PeopleImport.column_name(src,datasource_dbid) : '' }} <button class="btn btn-xs btn-link pull-right remove-mapping" mapping="datasource_dbid"><i class="glyphicon glyphicon-remove"></i></button></span>
            </li>
        </ul>
    </div>
</script>

<script type="text/template" id="csv-source">
    <div class="column {{if (typeof _.find(_.reject(_.pairs(mapping.attributes), function(n) { return ((n[0] == "datasource_id") || (n[0] == "id") || (n[0] == "lock_version")) }), function(v) {return v[1] == posn}) == 'undefined') {  }} ui-draggable {{ } else { }} mapping-assigned {{ } }}" id="{{= posn}}">
        {{= name ? name : '<i>?</i>' }} 
    </div>
</script>

<script type="text/template" id="step-4">
    <div id="step-4-text">
        <h3 class="h3-underlined"><%= t 'people-import-wizard-step-4'%></h3>
        <p><%= t 'people-import-wizard-step-4-text'%></p>
    </div>     
    <div id='form'></div>
</script>

<script type="text/template" id="result-template">
    <div id="step-5-text">
        <h3 class="h3-underlined"><%= t 'people-import-wizard-step-5'%></h3>
        <h4><%= t 'results'%></h4>
        <p><%= t "created" %>: {{= created }}</p>
        <p><%= t "updated" %>: {{= updates }}</p>
        <p><%= t "possible-matches" %>: {{= possible_matches }}</p>
        <p><%= t "registration-in-use" %> <a class="mtooltip"><i class="glyphicon glyphicon-info-sign"></i><span><%= t "registration-in-use-explanation" %></span></a> : {{= registration_in_use }}</p>
        <p><%= t "possible-name-updates" %>: {{= possible_name_updates }}</p>
    </div>
</script>
